import streamlit as stimport pandas as pdimport datetimeimport osEXCEL_PATH = "Workout_Log_4Weeks.xlsx"@st.cache_datadef load_data(sheet_name):    return pd.read_excel(EXCEL_PATH, sheet_name=sheet_name)def get_types(df):    return df[df['Exercise Name'].isnull() & df['Date'].str.contains('Type', na=False)]['Date'].tolist()def get_exercises(df, type_choice, types):    start_idx = df[df['Date'] == type_choice].index[0] + 1    if type_choice != types[-1]:        end_idx = df[df['Date'] == types[types.index(type_choice)+1]].index[0]    else:        end_idx = len(df)    return df.iloc[start_idx:end_idx]['Exercise Name'].dropna().tolist()def reset_fields():    st.session_state['date'] = datetime.date.today()    for i in range(1, 6):        st.session_state[f"reps_{i}"] = 0        st.session_state[f"weight_{i}"] = 0.0# UIst.title("Workout Logger (Excel)")week = st.selectbox("Kies week", ["Week 1", "Week 2", "Week 3", "Week 4"])df = load_data(week)types = get_types(df)type_choice = st.selectbox("Kies type", types)exercises = get_exercises(df, type_choice, types)exercise = st.selectbox("Kies oefening", exercises)# Datumveld (default vandaag)date = st.date_input("Datum", value=datetime.date.today(), key='date')# Invoervelden voor setsst.write("Vul je sets in (max 5):")sets = []for i in range(1, 6):    col1, col2 = st.columns(2)    reps = col1.number_input(f"Set {i} reps", min_value=0, max_value=100, value=st.session_state.get(f"reps_{i}", 0), key=f"reps_{i}")    weight = col2.number_input(f"Set {i} gewicht (kg)", min_value=0.0, max_value=500.0, value=st.session_state.get(f"weight_{i}", 0.0), key=f"weight_{i}")    sets.append((reps, weight))# Automatische berekeningenvolumes = [r * w for r, w in sets]total_reps = sum(r for r, _ in sets)average_weight = (sum(w * r for r, w in sets) / total_reps) if total_reps > 0 else 0max_weight = max(w for _, w in sets)total_volume = sum(volumes)# Samenvatting tonenst.markdown("**Samenvatting:**")st.write(f"Total reps: {total_reps}")st.write(f"Average weight: {average_weight:.1f} kg")st.write(f"Max weight: {max_weight} kg")st.write(f"Total volume: {total_volume} kg")# Validatievalid = any(r > 0 and w > 0 for r, w in sets)if not valid:    st.warning("Vul minimaal één set in met reps > 0 en gewicht > 0.")# Opslaanif st.button("Opslaan in Excel", disabled=not valid):    row_idx = df[(df['Exercise Name'] == exercise)].index[0]    df.at[row_idx, "Date"] = date.strftime("%Y-%m-%d")    for i in range(5):        df.at[row_idx, f"Set{i+1}_Reps (reps)"] = sets[i][0]        df.at[row_idx, f"Set{i+1}_Weight (kg)"] = sets[i][1]        df.at[row_idx, f"Set{i+1}_Volume (kg)"] = volumes[i]    df.at[row_idx, "Total Reps (reps)"] = total_reps    df.at[row_idx, "Average Weight (kg)"] = average_weight    df.at[row_idx, "Max Weight (kg)"] = max_weight    df.at[row_idx, "Total Volume (kg)"] = total_volume    # Sla op als nieuwe file    with pd.ExcelWriter(EXCEL_PATH, mode='a', if_sheet_exists='replace') as writer:        df.to_excel(writer, sheet_name=week, index=False)    st.success(f"Opgeslagen voor {exercise} op {date.strftime('%Y-%m-%d')}!")    st.balloons()# Reset-knopif st.button("Reset invoervelden"):    reset_fields()    st.experimental_rerun()st.info("Wil je deze app online gebruiken? Vraag gerust om uitleg over Streamlit Cloud of PythonAnywhere!")